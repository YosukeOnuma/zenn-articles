---
title: "離散ウェーブレット変換"
emoji: "🌊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["wavelet","信号処理","時間周波数解析"]
published: false
---

## 解説事項
- 離散ウェーブレット変換
- （発展）ウェーブレットパケット分解

そもそものウェーブレット変換や連続ver.の解説は前回参照

## 離散ウェーブレット変換を一言で
- 信号を，過不足なく（＝情報量不変で）高周波成分と低周波成分に可逆的に分解する
- 時間周波数解析よりもノイズ除去やファイル圧縮に使うイメージ


## 離散ウェーブレット変換（DWT）


DWTは，フィルタにより信号を高周波成分（detail coefficient）と低周波成分（appoximation coefficient）に分解する．そして低周波成分をさらに．このフィルタはマザーウェーブレットに依存する．なお図の□はノードと呼ばれる．

![](/images/wavelet-abstract/dwt.png)

- フィルタリングで得られる係数は時間の関数であるため，時間方向の情報は失われない．

    
- 思うに，DWTの最大の利点は，過不足なく，言い換えれば情報を落とすことなく信号を周波数ごとに分解できること．つまり係数から信号を再構成することができる．これは，DWTの結果各ノードが担当する周波数でバンドパスフィルタをかけることでは成し得ない（カットオフが完全でないため）．フーリエ変換して特定周波数以降をバッサリ切るのもありだが，イメージそれは計算量が多そう…？
- 逆に言えば，周波数バンドごとのパワーなどを見たい時は，DWTではなくバンドパスフィルタなどでも良いのかもしれない．
- 前述した「周波数ごとに異なる時間解像度」がこの離散WTでどのように生じるのかだが，Haarウェーブレットに関して言えば[このサイト](https://qiita.com/kaityo256/items/70dc20658ef98d229de9)がわかりやすい．例えば長さ100の信号なら，長さ50の大まかな形（＝低周波成分）＋長さ50の誤差項（＝高周波成分）と分解されるわけだ．つまり全体で100の値を扱っていることには変わりはない．他のウェーブレットでも同様である．

## DWTの式
離散WTでは，スケール$a$とシフト$b$を離散的に網羅することで高速化する．特に一般的な分割は２進分割，つまり
    
$$
a=2^{L-l},\quad b=k2^{L-l}
$$

と表せる．言葉にするなら， $a,b$  の値が冪乗に大きくなる．この時，信号をサンプリングし$x_n$と表すと，

$$
X_l(k,b)=\frac{1}{\sqrt{2^{L-l}}}\sum_n x_n \overline{\Psi \Big( \frac{t}{2^{L-l}}-k \Big)}
$$

↑あれスケーリング関数は？


## Wavelet Packet Decomposition（WPD）

- 離散WTは低周波成分をどんどん分解していった一方で，WPDは高周波数成分も同様に分解していく．すなわち周波数方向の分割は２進分割ではなく等間隔になり，周波数領域全体を等しく分解できる．
- WPDも離散WTで示したような木構造で表せ，その深さをLevelと呼ぶ
